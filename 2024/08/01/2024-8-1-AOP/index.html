<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="SleepingFace Blog"><meta property="og:type" content="article"><meta property="og:image" content="https://wangzhendong20.github.io//img/home1.jpg"><meta property="twitter:image" content="https://wangzhendong20.github.io//img/home1.jpg"><meta name=title content="利用AOP实现权限校验和请求响应日志输出"><meta property="og:title" content="利用AOP实现权限校验和请求响应日志输出"><meta property="twitter:title" content="利用AOP实现权限校验和请求响应日志输出"><meta name=description content="记录一下在SleepingFace BI项目里利用AOP实现了权限校验和请求响应日志输出。"><meta property="og:description" content="记录一下在SleepingFace BI项目里利用AOP实现了权限校验和请求响应日志输出。"><meta property="twitter:description" content="记录一下在SleepingFace BI项目里利用AOP实现了权限校验和请求响应日志输出。"><meta property="twitter:card" content="summary"><meta name=keyword content="WangZhendong"><link rel="shortcut icon" href=/img/favicon.ico><title>利用AOP实现权限校验和请求响应日志输出 | 王振东的博客 | SleepingFace Blog</title>
<link rel=canonical href=/2024/08/01/2024-8-1-AOP/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.css><link rel=stylesheet href=/css/font-awesome.all.min.css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/hux-blog.min.js></script><script src=/js/lazysizes.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/>SleepingFace Blog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>All Posts</a></li><li><a href=/categories/java/>java</a></li><li><a href=/categories/leetcode/>leetcode</a></li><li><a href=/categories/llm/>llm</a></li><li><a href=/categories/other/>other</a></li><li><a href=/categories/tech/>tech</a></li><li><a href=/archive//>ARCHIVE</a></li><li><a href=/notes//>NOTES</a></li><li><a href=/about//>ABOUT</a></li><li><a href=/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home1.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/tags/aop title=AOP>AOP
</a><a class=tag href=/tags/java title=Java>Java</a></div><h1>利用AOP实现权限校验和请求响应日志输出</h1><h2 class=subheading></h2><span class=meta>Posted by
SleepingFace
on
Thursday, August 1, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h1 id=利用aop实现权限校验和请求响应日志输出>利用AOP实现权限校验和请求响应日志输出</h1><p><strong>前言：</strong> 记录一下在<em>SleepingFace BI</em>项目里利用AOP做了什么？</p><ul><li>权限校验</li><li>请求响应日志输出</li></ul><h1 id=1-aop相关知识>1. AOP相关知识</h1><h2 id=11-aop简介>1.1 AOP简介</h2><p>AOP(Aspect-Oriented Programming:面向切面编程)能够将那些<strong>与业务无关</strong>，却为业务模块所<strong>共同调用</strong>的逻辑或责任（例如事务处理、日志管理、权限控制等）封装起来，便于减少系统的重复代码，降低模块间的耦合度，并有利于未来的可拓展性和可维护性。</p><p><strong>简单来说就是定义一个“方法”，各模块都能调用。</strong></p><p>Spring AOP 就是基于动态代理的，如果要代理的对象<strong>实现了某个接口</strong>，那么 Spring AOP 会使用 <strong>JDK Proxy</strong>，去创建代理对象，而对于<strong>没有实现接口的对象</strong>，就无法使用 JDK Proxy 去进行代理了，这时候 Spring AOP 会使用 <strong>Cglib</strong> 生成一个被代理对象的子类来作为代理，如下图所示：</p><p><img src=/img/2024-08-01-AOP/Snipaste_2024-08-02_20-22-45.png alt></p><p>AOP 切面编程涉及到的一些专业术语：</p><table><thead><tr><th style=text-align:center>术语</th><th style=text-align:center>含义</th></tr></thead><tbody><tr><td style=text-align:center>目标(Target)</td><td style=text-align:center>被通知的对象</td></tr><tr><td style=text-align:center>代理(Proxy)</td><td style=text-align:center>向目标对象应用通知之后创建的代理对象</td></tr><tr><td style=text-align:center>连接点(JoinPoint)</td><td style=text-align:center>目标对象的所属类中，定义的所有方法均为连接点</td></tr><tr><td style=text-align:center>切入点(Pointcut)</td><td style=text-align:center>被切面拦截 / 增强的连接点（切入点一定是连接点，连接点不一定是切入点）</td></tr><tr><td style=text-align:center>通知(Advice)</td><td style=text-align:center>增强的逻辑 / 代码，也即拦截到目标对象的连接点之后要做的事情</td></tr><tr><td style=text-align:center>切面(Aspect)</td><td style=text-align:center>切入点(Pointcut)+通知(Advice)</td></tr><tr><td style=text-align:center>Weaving(织入)</td><td style=text-align:center>将通知应用到目标对象，进而生成代理对象的过程动作</td></tr></tbody></table><h2 id=12-spring-aop--aspectj-aop>1.2 Spring AOP & AspectJ AOP</h2><p><strong>Spring AOP 属于运行时增强，而 AspectJ 是编译时增强。</strong> Spring AOP 基于代理(Proxying)，而 AspectJ 基于字节码操作(Bytecode Manipulation)。</p><p>Spring AOP 已经集成了 AspectJ ，AspectJ 应该算的上是 Java 生态系统中最完整的 AOP 框架了。AspectJ 相比于 Spring AOP 功能更加强大，但是 Spring AOP 相对来说更简单，</p><p>如果我们的切面比较少，那么两者性能差异不大。但是，当切面太多的话，最好选择 AspectJ ，它比 Spring AOP 快很多。</p><h2 id=13-aspectj定义的通知类型>1.3 AspectJ定义的通知类型</h2><ul><li><p><strong>Before</strong>（前置通知）：目标对象的方法调用之前触发</p></li><li><p><strong>After</strong> （后置通知）：目标对象的方法调用之后触发</p></li><li><p><strong>AfterReturning</strong>（返回通知）：目标对象的方法调用完成，在返回结果值之后触发</p></li><li><p><strong>AfterThrowing</strong>（异常通知）：目标对象的方法运行中抛出 / 触发异常后触发。<code>AfterReturning </code>和<code>AfterThrowing</code>两者互斥。如果方法调用成功无异常，则会有返回值；如果方法抛出了异常，则不会有返回值。</p></li><li><p><strong>Around</strong> （环绕通知）：编程式控制目标对象的方法调用。环绕通知是所有通知类型中可操作范围最大的一种，因为它可以直接拿到目标对象，以及要执行的方法，所以环绕通知可以任意的在目标对象的方法调用前后搞事，甚至不调用目标对象的方法</p></li></ul><h1 id=2-利用aop实现权限校验>2. 利用AOP实现权限校验</h1><h2 id=21-声明注解>2.1 声明注解</h2><p>用户角色分为user和admin，有些方法只能admin才能调用。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>@Target(ElementType.<span style=color:#50fa7b>METHOD</span>)
</span></span><span style=display:flex><span>@Retention(RetentionPolicy.<span style=color:#50fa7b>RUNTIME</span>)
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> @interface AuthCheck {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>/**
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * 必须有某个角色
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     *
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * @return
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     */</span>
</span></span><span style=display:flex><span>    String <span style=color:#50fa7b>mustRole</span>() <span style=color:#ff79c6>default</span> <span style=color:#f1fa8c>&#34;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>注解声明</strong>: <code>@interface AuthCheck</code></p><ul><li>声明了一个名为 <code>AuthCheck</code> 的自定义注解。</li></ul><p><strong>Target</strong>: <code>@Target(ElementType.METHOD)</code></p><ul><li>这个注解只能被应用在方法上。</li></ul><p><strong>Retention</strong>: <code>@Retention(RetentionPolicy.RUNTIME)</code></p><ul><li>这个注解在运行时可用，意味着它可以通过反射在程序执行过程中获取。</li></ul><p><strong>mustRole 方法</strong>:</p><ul><li>这个方法定义了一个参数 <code>mustRole</code>，可以在使用注解时指定。默认值为空字符串，表示没有指定必须的角色，除非在使用注解时明确指定。</li></ul><h2 id=22-编写拦截器>2.2 编写拦截器</h2><p><code>@Aspect</code>: 表示这个类是一个切面类，用于定义切面逻辑。</p><p>加入<code>@Component</code>注解交给Spring管理。</p><p><code>@Around("@annotation(authCheck)")</code>: 这个注解表示拦截所有带有 <code>@AuthCheck</code> 注解的方法，并在这些方法执行前后执行 <code>doInterceptor</code> 方法。</p><p><code>ProceedingJoinPoint joinPoint</code>: 表示连接点，可以通过它调用被拦截的方法。</p><p><code>AuthCheck authCheck</code>: 通过这个参数获取 <code>@AuthCheck</code> 注解的信息， <code>mustRole</code>。</p><p>在方法里，我们比对<code>loginUser.getUserRole()</code>和<code>authCheck.mustRole()</code>，相等就可放行，否则抛出异常。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>@Aspect
</span></span><span style=display:flex><span>@Component
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>AuthInterceptor</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    @Resource
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>private</span> UserService userService;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>/**
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * 执行拦截
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     *
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * @param joinPoint
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * @param authCheck
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * @return
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     */</span>
</span></span><span style=display:flex><span>    @Around(<span style=color:#f1fa8c>&#34;@annotation(authCheck)&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> Object <span style=color:#50fa7b>doInterceptor</span>(ProceedingJoinPoint joinPoint, AuthCheck authCheck) <span style=color:#8be9fd;font-style:italic>throws</span> Throwable {
</span></span><span style=display:flex><span>        String mustRole <span style=color:#ff79c6>=</span> authCheck.<span style=color:#50fa7b>mustRole</span>();
</span></span><span style=display:flex><span>        RequestAttributes requestAttributes <span style=color:#ff79c6>=</span> RequestContextHolder.<span style=color:#50fa7b>currentRequestAttributes</span>();
</span></span><span style=display:flex><span>        HttpServletRequest request <span style=color:#ff79c6>=</span> ((ServletRequestAttributes) requestAttributes).<span style=color:#50fa7b>getRequest</span>();
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 当前登录用户</span>
</span></span><span style=display:flex><span>        User loginUser <span style=color:#ff79c6>=</span> userService.<span style=color:#50fa7b>getLoginUser</span>(request);
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 必须有该权限才通过</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> (StringUtils.<span style=color:#50fa7b>isNotBlank</span>(mustRole)) {
</span></span><span style=display:flex><span>            UserRoleEnum mustUserRoleEnum <span style=color:#ff79c6>=</span> UserRoleEnum.<span style=color:#50fa7b>getEnumByValue</span>(mustRole);
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span> (mustUserRoleEnum <span style=color:#ff79c6>==</span> <span style=color:#ff79c6>null</span>) {
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> BusinessException(ErrorCode.<span style=color:#50fa7b>NO_AUTH_ERROR</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            String userRole <span style=color:#ff79c6>=</span> loginUser.<span style=color:#50fa7b>getUserRole</span>();
</span></span><span style=display:flex><span>            <span style=color:#6272a4>// 如果被封号，直接拒绝</span>
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span> (UserRoleEnum.<span style=color:#50fa7b>BAN</span>.<span style=color:#50fa7b>equals</span>(mustUserRoleEnum)) {
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> BusinessException(ErrorCode.<span style=color:#50fa7b>NO_AUTH_ERROR</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#6272a4>// 必须有管理员权限</span>
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span> (UserRoleEnum.<span style=color:#50fa7b>ADMIN</span>.<span style=color:#50fa7b>equals</span>(mustUserRoleEnum)) {
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>!</span>mustRole.<span style=color:#50fa7b>equals</span>(userRole)) {
</span></span><span style=display:flex><span>                    <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> BusinessException(ErrorCode.<span style=color:#50fa7b>NO_AUTH_ERROR</span>);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 通过权限校验，放行</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> joinPoint.<span style=color:#50fa7b>proceed</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=23-在需要的方法上加入注解>2.3 在需要的方法上加入注解</h2><p>在方法加上注解<code>@AuthCheck(mustRole = UserConstant.ADMIN_ROLE)</code>就可以了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>@GetMapping(<span style=color:#f1fa8c>&#34;/get&#34;</span>)
</span></span><span style=display:flex><span>@AuthCheck(mustRole <span style=color:#ff79c6>=</span> UserConstant.<span style=color:#50fa7b>ADMIN_ROLE</span>)
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> BaseResponse<span style=color:#ff79c6>&lt;</span>User<span style=color:#ff79c6>&gt;</span> <span style=color:#50fa7b>getUserById</span>(<span style=color:#8be9fd>long</span> id, HttpServletRequest request) {
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> (id <span style=color:#ff79c6>&lt;=</span> 0) {
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> BusinessException(ErrorCode.<span style=color:#50fa7b>PARAMS_ERROR</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    User user <span style=color:#ff79c6>=</span> userService.<span style=color:#50fa7b>getById</span>(id);
</span></span><span style=display:flex><span>    ThrowUtils.<span style=color:#50fa7b>throwIf</span>(user <span style=color:#ff79c6>==</span> <span style=color:#ff79c6>null</span>, ErrorCode.<span style=color:#50fa7b>NOT_FOUND_ERROR</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> ResultUtils.<span style=color:#50fa7b>success</span>(user);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=3-利用aop实现请求响应日志输出>3. 利用AOP实现请求响应日志输出</h1><p><code>@Around("execution(* com.dong.chart.controller.*.*(..))")</code>: 这个注解表示拦截 <code>com.dong.chart.controller</code> 包下的所有类的所有方法，并在这些方法执行前后执行 <code>doInterceptor</code> 方法。</p><p>其余部分跟 <em>权限校验</em> 基本相同。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>@Aspect
</span></span><span style=display:flex><span>@Component
</span></span><span style=display:flex><span>@Slf4j
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>LogInterceptor</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>/**
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * 执行拦截
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     */</span>
</span></span><span style=display:flex><span>    @Around(<span style=color:#f1fa8c>&#34;execution(* com.dong.chart.controller.*.*(..))&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> Object <span style=color:#50fa7b>doInterceptor</span>(ProceedingJoinPoint point) <span style=color:#8be9fd;font-style:italic>throws</span> Throwable {
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 计时</span>
</span></span><span style=display:flex><span>        StopWatch stopWatch <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> StopWatch();
</span></span><span style=display:flex><span>        stopWatch.<span style=color:#50fa7b>start</span>();
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 获取请求路径</span>
</span></span><span style=display:flex><span>        RequestAttributes requestAttributes <span style=color:#ff79c6>=</span> RequestContextHolder.<span style=color:#50fa7b>currentRequestAttributes</span>();
</span></span><span style=display:flex><span>        HttpServletRequest httpServletRequest <span style=color:#ff79c6>=</span> ((ServletRequestAttributes) requestAttributes).<span style=color:#50fa7b>getRequest</span>();
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 生成请求唯一 id</span>
</span></span><span style=display:flex><span>        String requestId <span style=color:#ff79c6>=</span> UUID.<span style=color:#50fa7b>randomUUID</span>().<span style=color:#50fa7b>toString</span>();
</span></span><span style=display:flex><span>        String url <span style=color:#ff79c6>=</span> httpServletRequest.<span style=color:#50fa7b>getRequestURI</span>();
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 获取请求参数</span>
</span></span><span style=display:flex><span>        Object<span style=color:#ff79c6>[]</span> args <span style=color:#ff79c6>=</span> point.<span style=color:#50fa7b>getArgs</span>();
</span></span><span style=display:flex><span>        String reqParam <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;[&#34;</span> <span style=color:#ff79c6>+</span> StringUtils.<span style=color:#50fa7b>join</span>(args, <span style=color:#f1fa8c>&#34;, &#34;</span>) <span style=color:#ff79c6>+</span> <span style=color:#f1fa8c>&#34;]&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 输出请求日志</span>
</span></span><span style=display:flex><span>        log.<span style=color:#50fa7b>info</span>(<span style=color:#f1fa8c>&#34;request start，id: {}, path: {}, ip: {}, params: {}&#34;</span>, requestId, url,
</span></span><span style=display:flex><span>                httpServletRequest.<span style=color:#50fa7b>getRemoteHost</span>(), reqParam);
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 执行原方法</span>
</span></span><span style=display:flex><span>        Object result <span style=color:#ff79c6>=</span> point.<span style=color:#50fa7b>proceed</span>();
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// 输出响应日志</span>
</span></span><span style=display:flex><span>        stopWatch.<span style=color:#50fa7b>stop</span>();
</span></span><span style=display:flex><span>        <span style=color:#8be9fd>long</span> totalTimeMillis <span style=color:#ff79c6>=</span> stopWatch.<span style=color:#50fa7b>getTotalTimeMillis</span>();
</span></span><span style=display:flex><span>        log.<span style=color:#50fa7b>info</span>(<span style=color:#f1fa8c>&#34;request end, id: {}, cost: {}ms&#34;</span>, requestId, totalTimeMillis);
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> result;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><em>注：本文参考了 JavaGuide 和 编程导航，AOP相关知识的原文链接 <a href=https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html>https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html</a></em></p><div class="entry-shang text-center"><p>「给个赞赏，支持一下作者吧~」</p><button class="zs show-zs btn btn-bred">赞赏支持</button></div><div class=zs-modal-bg></div><div class=zs-modal-box><div class=zs-modal-head><button type=button class=close>×</button>
<span class=author><a href=https://wangzhendong20.github.io/><img src=/img/favicon.png>SleepingFace Blog</a></span><p class=tip><i></i><span>给个赞赏，支持一下作者吧~</span></p></div><div class=zs-modal-body><div class=zs-modal-btns><button class="btn btn-blink" data-num=2>2元</button>
<button class="btn btn-blink" data-num=5>5元</button>
<button class="btn btn-blink" data-num=10>10元</button>
<button class="btn btn-blink" data-num=50>50元</button>
<button class="btn btn-blink" data-num=100>100元</button>
<button class="btn btn-blink" data-num=1>任意金额</button></div><div class=zs-modal-pay><button class="btn btn-bred" id=pay-text>2元</button><p>使用<span id=pay-type>微信</span>扫描二维码完成支付</p><img src=/img/reward/wechat-2.png id=pay-image></div></div><div class=zs-modal-footer><label><input type=radio name=zs-type value=wechat class=zs-type checked><span><span class=zs-wechat><img src=/img/reward/wechat-btn.png></span></label>
<label><input type=radio name=zs-type value=alipay class=zs-type class=zs-alipay><img src=/img/reward/alipay-btn.png></span></label></div></div><script type=text/javascript src=/js/reward.js></script><hr><ul class=pager><li class=previous><a href=/2024/07/31/2024-7-31-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/ data-toggle=tooltip data-placement=top title=策略模式+工厂模式实现多种文件类型上传处理>&larr;
Previous Post</a></li><li class=next><a href=/2024/08/02/2024-08-02-leetcodeDaily1/ data-toggle=tooltip data-placement=top title="每日一题 - 2024/8/2">Next
Post &rarr;</a></li></ul><script src=https://giscus.app/client.js data-repo=wangzhendong20/wangzhendong20.github.io data-repo-id=***************************** data-category=**************************** data-category-id=************************** data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=light data-lang=en crossorigin=anonymous async></script></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/tags/java title=java>java
</a><a href=/tags/leetcode title=leetcode>leetcode
</a><a href=/tags/%E7%AE%97%E6%B3%95 title=算法>算法</a></div></section><section><hr><h5>FRIENDS</h5><ul class=list-inline><li><a target=_blank href=https://tanxiangyuu.github.io>谭总的博客</a></li></ul></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:wangzhendong20@163.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/wangzhendong20><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title="SleepingFace Blog"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">&copy; SleepingFace Blog 2024<br><a>欢迎评论哦！</a></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script>(function(){var t,e=document.createElement("script"),n=window.location.protocol.split(":")[0];n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script><script>var _baId="8cc115b1ee28b68ce1138a4281875e00",_hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="//hm.baidu.com/hm.js?"+_baId,e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){t=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),n=$(this).text(),i=$('<a href="'+o+'" rel="nofollow">'+n+"</a>"),s=$('<li class="'+t+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>